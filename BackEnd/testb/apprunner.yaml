version: 1.0
runtime: nodejs18

network:
  vpc-connector: vpc-0d15d0d7c9164f598
build:
  commands:
    pre-build:
      - npm ci
    build:
      - npm run build
    post-build:
      - npm run seed
run:
  runtime-version: 18.x
  command: npm run start:prod
  network:
    port: 8080
    env: PORT
  env:
    - name: NODE_ENV
      value: DEVELOPMENT
    - name: PORT
      value: 8080
    # Database configuration
    - name: DB_HOST
      value: "${DB_HOST}"
    - name: DB_PORT
      value: "${DB_PORT}"
    - name: DB_USERNAME
      value: "${DB_USERNAME}"
    - name: DB_PASSWORD
      value: "${DB_PASSWORD}"
    - name: DB_DATABASE
      value: "${DB_DATABASE}"
    - name: DB_SYNCHRONIZE
      value: "false"
    # SSL configuration for database
    - name: DB_USE_SSL
      value: "${DB_USE_SSL}"
    - name: DB_REJECT_UNAUTHORIZED
      value: "${DB_REJECT_UNAUTHORIZED}"
    - name: DB_SSL_CA_PATH
      value: "${DB_SSL_CA_PATH}"